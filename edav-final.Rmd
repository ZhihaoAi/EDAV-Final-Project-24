---
title: "edav-final"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
library(forcats)
library(Hmisc)

# set color
mycolor <- "#80593D"
myfill <- "#9FC29F"

# load data
moma_artists <- read_csv("./data/Artists.csv")
moma_artworks <- read_csv("./data/Artworks.csv")

# keep the columns we need
moma_artists <- moma_artists[c(1,2,4,5,6,7)]

# count by nationality
moma_artists_nationality <- moma_artists[3] %>% group_by(Nationality) %>% dplyr::summarize(Frequency=n()) %>% arrange(Frequency)

# check the stats summary of this dataset
describe(moma_artists_nationality)
```

We realize that 5% of the artists featured in MOMA determined the majority of the MOMA collection; thus, we plot the top 5%

```{r}
moma_artists_nat_5per <- moma_artists_nationality %>% group_by (Frequency) %>% filter(Frequency > 436)

# frequency of nationality

ggplot(moma_artists_nat_5per, aes(fct_reorder(Nationality, Frequency), Frequency)) +
  geom_bar(stat = "identity") +
  ggtitle("MOMA Artist Nationality by Frequency (top 5%)") +
  xlab("Nationality") +
  geom_col(color = mycolor, fill = myfill) +
  coord_flip() +
  theme(plot.title = element_text(face = "bold"))

```

```{r}
#  if by top 10%
moma_artists_nat_10per <- moma_artists_nationality %>% group_by (Frequency) %>% filter(Frequency > 173)

# frequency of nationality
ggplot(moma_artists_nat_10per, aes(fct_reorder(Nationality, Frequency), Frequency)) +
  geom_bar(stat = "identity") +
  ggtitle("MOMA Artist Nationality by Frequency (top 10%)") +
  xlab("Nationality") +
  geom_col(color = mycolor, fill = myfill) +
  coord_flip() +
  theme(plot.title = element_text(face = "bold"))
```

```{r}
# now test birth year
moma_artists_birth_year <- moma_artists[5] %>% group_by (BeginDate) %>% dplyr::summarize(Frequency=n()) %>% arrange(Frequency)

# again, check the stats
describe(moma_artists_birth_year)
```

since the number seems enough (more than 100), we will see per year for now.

```{r}
# let's see the top 5%
moma_artists_birth_year_5per <- moma_artists_birth_year %>% group_by(Frequency) %>% filter(Frequency > 153)

# and exclude NA for now
moma_artists_birth_year_5per <- moma_artists_birth_year_5per[1:10,]

moma_artists_birth_year_5per$BeginDate <- as.character(moma_artists_birth_year_5per$BeginDate)

# frequency of birth year
ggplot(moma_artists_birth_year_5per, aes(BeginDate, Frequency)) +
  geom_bar(stat = "identity") +
  ggtitle("MOMA Artist Birth Year by Frequency (top 5%)") +
  xlab("Birth Year") +
  geom_col(color = mycolor, fill = myfill) +
  coord_flip() +
  theme(plot.title = element_text(face = "bold"))
```

From this bar chart, we observed that 1940 and 1943 be the popular artist birth years collected by MOMA.

```{r}
# let's see the top 10%
moma_artists_birth_year_10per <- moma_artists_birth_year %>% group_by(Frequency) %>% filter(Frequency > 138)

# and exclude NA for now
moma_artists_birth_year_10per <- moma_artists_birth_year_10per[1:23,]

moma_artists_birth_year_10per$BeginDate <- as.character(moma_artists_birth_year_10per$BeginDate)

# frequency of birth year
ggplot(moma_artists_birth_year_10per, aes(BeginDate, Frequency)) +
  geom_bar(stat = "identity") +
  ggtitle("MOMA Artist Birth Year by Frequency (top 10%)") +
  xlab("Birth Year") +
  geom_col(color = mycolor, fill = myfill) +
  coord_flip() +
  theme(plot.title = element_text(face = "bold"))
```

```{r}
# Now, let's check by gender of those top 5%
moma_artists$Gender <- tolower(moma_artists$Gender)
moma_artists_gender <- moma_artists[3:4] %>% group_by(Gender, Nationality) %>% dplyr::summarize(Frequency=n()) %>% arrange(Frequency) %>% filter(Nationality %in% c("American", "British", "German", "Italian", "Japanese"))

```

```{r}

#if exclude NA for now
moma_artists_gender_nona <- moma_artists_gender %>% group_by(Gender) %>% filter(Gender %in% c("female", "male"))

ggplot(moma_artists_gender_nona, aes(Nationality, Frequency, fill = Gender)) +
  geom_bar(stat = "identity") +
  ggtitle("MOMA Artist Nationality by Frequency, Colored by Gender (top 5%)") +
  xlab("Nationality") +
  scale_fill_brewer(palette= "Oranges")+
  geom_col(color = mycolor) +
  coord_flip() +
  theme(plot.title = element_text(face = "bold"))

```

```{r}
# similarily, for birth year
moma_artists_birth_year_gender <- moma_artists[4:5] %>% group_by(Gender, BeginDate) %>% dplyr::summarize(Frequency=n()) %>% arrange(Frequency)

# just check the top 5%
moma_artists_birth_year_gender$BeginDate <- factor(moma_artists_birth_year_gender$BeginDate, levels = moma_artists_birth_year_5per$BeginDate)

# take out NAs
moma_artists_birth_year_gender <- moma_artists_birth_year_gender %>% group_by(BeginDate) %>% filter( !is.na(BeginDate))

moma_artists_birth_year_gender_nona <- moma_artists_birth_year_gender %>% group_by(Gender) %>% filter(Gender %in% c("female", "male"))

# plot it
ggplot(moma_artists_birth_year_gender_nona, aes(BeginDate, Frequency, fill = Gender)) +
  geom_bar(stat = "identity") +
  ggtitle("MOMA Artist Birth Year by Frequency, Colored by Gender (top 5%)") +
  xlab("Nationality") +
  scale_fill_brewer(palette= "Oranges")+
  geom_col(color = mycolor) +
  coord_flip() +
  theme(plot.title = element_text(face = "bold"))

```